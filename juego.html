<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Finanzas</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f9;
            text-align: center;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        /* Estilos del √°rea de juego */
        #game-container {
            width: 400px;
            height: 600px;
            background-color: #70c5ce; /* Cielo azul */
            border: 5px solid #333;
            position: relative;
            overflow: hidden;
            margin-bottom: 20px;
        }

        /* Estilos del p√°jaro */
        #bird {
            width: 30px;
            height: 30px;
            background-color: #ffeb3b; /* Amarillo */
            border-radius: 50%;
            border: 2px solid #e2a500;
            position: absolute;
            left: 50px;
            transition: top 0.05s linear; /* Para una ca√≠da m√°s suave */
        }

        /* Estilos de las tuber√≠as (Pipes) */
        .pipe {
            position: absolute;
            width: 50px;
            background-color: #74bf2e;
            border: 2px solid #3e7b14;
        }

        .pipe-top {
            top: 0;
        }

        .pipe-bottom {
            bottom: 0;
        }

        #score-display {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 2em;
            color: white;
            text-shadow: 2px 2px 4px #000;
            z-index: 10;
        }

        #start-message, #game-over {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 20px;
            border-radius: 10px;
            cursor: pointer;
            z-index: 20;
        }

        /* Estilos del Modal de Preguntas */
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8);
        }
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 450px;
            box-shadow: 0 5px 15px rgba(255, 255, 255, 0.5);
            animation: fadeIn 0.5s;
            color: #333;
        }
        .quiz-option {
            text-align: left;
            margin: 10px 0;
        }
        .quiz-option label {
            display: block;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
            cursor: pointer;
        }
        .quiz-option label:hover {
            background-color: #e9ecef;
        }
        #feedback {
            margin-top: 15px;
            font-weight: bold;
        }
        .correct { color: green; }
        .incorrect { color: red; }
    </style>
</head>
<body>

    <h1>üê¶ Flappy Finanzas: Pasa 2 Tuber√≠as para la Pregunta üß†</h1>

    <div id="game-container">
        <div id="bird"></div>
        <div id="score-display">Puntos: 0</div>
        <div id="start-message">Haz click para empezar y saltar.</div>
        <div id="game-over" style="display: none;">¬°Juego Terminado! Click para reiniciar.</div>
    </div>

    <div id="questions-completed">Preguntas contestadas: 0 / 10</div>

    <div id="quiz-modal" class="modal">
        <div class="modal-content">
            <h2>Pregunta Financiera N¬∞<span id="q-number"></span></h2>
            <p id="q-text">Cargando pregunta...</p>

            <form id="quiz-form">
                <div id="q-options-container">
                    </div>
                <button type="submit" id="submit-answer">Responder</button>
            </form>
            <div id="feedback"></div>
        </div>
    </div>

    <script>
        // --- 1. Definici√≥n de Preguntas ---
        const questions = [
            {
                q: "¬øQu√© herramienta oficial del BCRA usas para revisar la situaci√≥n de deuda de una persona?",
                options: ["CUIT Online", "Consulta de Deuda del BCRA", "Registro de la Propiedad"],
                answer: 1 // √çndice de la respuesta correcta (empezando en 0)
            },
            {
                q: "¬øCu√°l de estos NO es un tipo de Swap financiero?",
                options: ["Swap de Divisas", "Swap de Tasas de Inter√©s", "Swap de Inmuebles"],
                answer: 2
            },
            {
                q: "Si la persona a la que quieres prestar dinero tiene deudas importantes o atrasos, ¬øqu√© indica?",
                options: ["Bajo riesgo de no cobro", "Riesgo alto de no cobro", "Que la tasa de inter√©s baj√≥"],
                answer: 1
            },
            {
                q: "¬øPara qu√© sirve el CUIT Online adem√°s de verificar el n√∫mero de CUIT?",
                options: ["Para ver su saldo bancario.", "Para consultar su actividad y estado fiscal.", "Para enviar un mail."],
                answer: 1
            },
            {
                q: "Un Swap de Divisas implica el intercambio de flujos de dinero en...",
                options: ["La misma moneda", "Diferentes monedas", "Solo en pesos argentinos"],
                answer: 1
            },
            {
                q: "¬øQu√© se recomienda firmar siempre al prestar dinero, si es posible?",
                options: ["Un contrato o acuerdo formal", "Una selfie de ambos", "Un recibo de supermercado"],
                answer: 0
            },
            {
                q: "El Swap de Commodities se basa en el precio de materias primas como el petr√≥leo. ¬øVerdadero o Falso?",
                options: ["Verdadero", "Falso"],
                answer: 0
            },
            {
                q: "Si el historial crediticio de alguien est√° 'limpio', ¬øc√≥mo afecta el riesgo de prestarle dinero?",
                options: ["Aumenta el riesgo", "Disminuye el riesgo", "No tiene relaci√≥n"],
                answer: 1
            },
            {
                q: "¬øQu√© es la Categor√≠a 5 en el BCRA (Irrecuperable)?",
                options: ["Una categor√≠a de alto riesgo", "Una categor√≠a de muy bajo riesgo"],
                answer: 0
            },
            {
                q: "Un 'swap' es un acuerdo financiero para intercambiar flujos de dinero futuros. ¬øVerdadero o Falso?",
                options: ["Verdadero", "Falso"],
                answer: 0
            }
        ];
        
        // --- 2. Variables del Juego ---
        const gameContainer = document.getElementById('game-container');
        const bird = document.getElementById('bird');
        const scoreDisplay = document.getElementById('score-display');
        const startMessage = document.getElementById('start-message');
        const gameOverDiv = document.getElementById('game-over');
        const completedDisplay = document.getElementById('questions-completed');
        
        const GRAVITY = 0.5;
        const JUMP_FORCE = -10;
        const PIPE_SPEED = 3;
        const PIPE_GAP = 150; // Espacio vertical entre tuber√≠as
        const QUESTION_THRESHOLD = 2; // Tuber√≠as a pasar antes de la pregunta
        
        let birdY = 300;
        let birdVelocity = 0;
        let gameLoopInterval;
        let pipeGenerationInterval;
        let isGameRunning = false;
        let score = 0;
        let pipesPassedSinceQuestion = 0;
        let questionsAnswered = 0;
        let pipes = [];

        // --- 3. Variables del Quiz ---
        const modal = document.getElementById('quiz-modal');
        const quizForm = document.getElementById('quiz-form');
        const feedbackDiv = document.getElementById('feedback');
        let currentQuestionIndex = 0;
        let isQuestionActive = false;

        // --- 4. Funciones del Juego ---

        function startGame() {
            if (isGameRunning) return;
            
            isGameRunning = true;
            gameOverDiv.style.display = 'none';
            startMessage.style.display = 'none';
            
            // Reiniciar variables
            birdY = 300;
            birdVelocity = 0;
            score = 0;
            pipesPassedSinceQuestion = 0;
            bird.style.top = `${birdY}px`;
            scoreDisplay.textContent = `Puntos: ${score}`;

            // Eliminar tuber√≠as existentes
            pipes.forEach(pipe => pipe.top.remove());
            pipes = [];
            
            // Iniciar loops
            gameLoopInterval = setInterval(gameLoop, 20);
            pipeGenerationInterval = setInterval(generatePipe, 2000);
            document.addEventListener('click', flap);
        }

        function flap() {
            if (isGameRunning) {
                birdVelocity = JUMP_FORCE;
            }
        }

        function gameLoop() {
            // 1. Movimiento del P√°jaro (Gravedad)
            birdVelocity += GRAVITY;
            birdY += birdVelocity;
            bird.style.top = `${birdY}px`;

            // 2. Movimiento y Creaci√≥n de Tuber√≠as
            movePipes();

            // 3. Chequeo de Colisiones (Ground/Ceiling/Pipes)
            checkCollisions();

            // 4. Chequeo de Puntuaci√≥n/Pregunta
            checkScoreAndQuestion();
        }

        function generatePipe() {
            if (!isGameRunning) return;
            
            const gapHeight = PIPE_GAP;
            const minPipeHeight = 50;
            const maxPipeHeight = gameContainer.offsetHeight - gapHeight - minPipeHeight;
            
            // Altura aleatoria de la tuber√≠a superior
            const topHeight = Math.floor(Math.random() * (maxPipeHeight - minPipeHeight) + minPipeHeight);
            const bottomHeight = gameContainer.offsetHeight - topHeight - gapHeight;

            // Elementos DOM
            const pipeTop = document.createElement('div');
            pipeTop.classList.add('pipe', 'pipe-top');
            pipeTop.style.height = `${topHeight}px`;
            pipeTop.style.left = `${gameContainer.offsetWidth}px`;
            
            const pipeBottom = document.createElement('div');
            pipeBottom.classList.add('pipe', 'pipe-bottom');
            pipeBottom.style.height = `${bottomHeight}px`;
            pipeBottom.style.left = `${gameContainer.offsetWidth}px`;

            gameContainer.appendChild(pipeTop);
            gameContainer.appendChild(pipeBottom);

            pipes.push({ 
                top: pipeTop, 
                bottom: pipeBottom, 
                x: gameContainer.offsetWidth,
                passed: false 
            });
        }

        function movePipes() {
            pipes.forEach(pipe => {
                pipe.x -= PIPE_SPEED;
                pipe.top.style.left = `${pipe.x}px`;
                pipe.bottom.style.left = `${pipe.x}px`;

                // Eliminar tuber√≠a que sali√≥ de la pantalla
                if (pipe.x + 50 < 0) {
                    pipe.top.remove();
                    pipe.bottom.remove();
                }
            });

            // Filtrar las tuber√≠as que han salido
            pipes = pipes.filter(pipe => pipe.x + 50 > 0);
        }

        function checkCollisions() {
            // Colisi√≥n con el suelo o el techo
            if (birdY > gameContainer.offsetHeight - 30 || birdY < 0) {
                endGame();
                return;
            }

            // Colisi√≥n con las tuber√≠as
            const birdRect = bird.getBoundingClientRect();
            const containerRect = gameContainer.getBoundingClientRect();

            pipes.forEach(pipe => {
                const pipeRectTop = pipe.top.getBoundingClientRect();
                const pipeRectBottom = pipe.bottom.getBoundingClientRect();

                // Detecci√≥n de colisi√≥n (simplificada)
                const birdX = birdRect.left - containerRect.left;
                const pipeX = pipe.x;

                if (birdX < pipeX + 50 && birdX + 30 > pipeX) {
                    // Colisi√≥n vertical con la tuber√≠a superior o inferior
                    if (birdY < pipeRectTop.height || birdY + 30 > (gameContainer.offsetHeight - pipeRectBottom.height)) {
                        endGame();
                    }
                }
            });
        }

        function checkScoreAndQuestion() {
            pipes.forEach(pipe => {
                if (!pipe.passed && pipe.x < 50) { // El p√°jaro pas√≥ el eje X de la tuber√≠a
                    pipe.passed = true;
                    score++;
                    pipesPassedSinceQuestion++;
                    scoreDisplay.textContent = `Puntos: ${score}`;

                    // L√≥gica de pregunta
                    if (pipesPassedSinceQuestion >= QUESTION_THRESHOLD && questionsAnswered < questions.length && !isQuestionActive) {
                        isQuestionActive = true;
                        endGameLoop(); // Detener el juego para la pregunta
                        showQuestion(questionsAnswered);
                    }
                }
            });
        }

        function endGameLoop() {
            clearInterval(gameLoopInterval);
            clearInterval(pipeGenerationInterval);
            isGameRunning = false;
            document.removeEventListener('click', flap);
        }

        function endGame() {
            endGameLoop();
            gameOverDiv.style.display = 'block';
            gameOverDiv.innerHTML = `¬°Juego Terminado! Puntuaci√≥n final: ${score}. <br> Click para reiniciar.`;
        }
        
        // --- 5. Funciones del Quiz ---

        function showQuestion(index) {
            const qData = questions[index];
            document.getElementById('q-number').textContent = index + 1;
            document.getElementById('q-text').textContent = qData.q;
            feedbackDiv.textContent = '';
            quizForm.reset();

            const optionsContainer = document.getElementById('q-options-container');
            optionsContainer.innerHTML = ''; 

            qData.options.forEach((option, i) => {
                const div = document.createElement('div');
                div.classList.add('quiz-option');
                div.innerHTML = `
                    <label>
                        <input type="radio" name="answer" value="${i}" required>
                        ${option}
                    </label>
                `;
                optionsContainer.appendChild(div);
            });

            modal.style.display = 'block';
        }

        function checkAnswer(event) {
            event.preventDefault();

            const selectedOption = quizForm.querySelector('input[name="answer"]:checked');
            if (!selectedOption) {
                feedbackDiv.textContent = "¬°Debes seleccionar una respuesta!";
                feedbackDiv.classList.add('incorrect');
                return;
            }

            const selectedIndex = parseInt(selectedOption.value);
            const qData = questions[currentQuestionIndex];

            if (selectedIndex === qData.answer) {
                // Respuesta Correcta: Contin√∫a el juego
                questionsAnswered++;
                pipesPassedSinceQuestion = 0; // Reinicia el contador de tuber√≠as
                completedDisplay.textContent = `Preguntas contestadas: ${questionsAnswered} / ${questions.length}`;
                
                feedbackDiv.textContent = "¬°Correcto! Contin√∫a volando.";
                feedbackDiv.classList.remove('incorrect');
                feedbackDiv.classList.add('correct');

                // Permitir al usuario ver el feedback brevemente antes de cerrar el modal
                setTimeout(() => {
                    modal.style.display = 'none';
                    isQuestionActive = false;
                    
                    if (questionsAnswered >= questions.length) {
                        // Fin de todas las preguntas
                        endGameLoop();
                        gameOverDiv.style.display = 'block';
                        gameOverDiv.innerHTML = `<h2>üéâ ¬°Ganaste! üéâ</h2> Completaste todas las ${questions.length} preguntas. Puntuaci√≥n final: ${score}. <br> Click para reiniciar.`;
                    } else {
                        startGame(); // Vuelve a iniciar el juego (re-activa los loops)
                    }
                }, 1500);

            } else {
                // Respuesta Incorrecta: Penalizaci√≥n (Fin del juego)
                feedbackDiv.textContent = "Incorrecto. ¬°El juego ha terminado! Tu p√°jaro cae por la penalizaci√≥n.";
                feedbackDiv.classList.remove('correct');
                feedbackDiv.classList.add('incorrect');
                
                setTimeout(() => {
                    modal.style.display = 'none';
                    endGame();
                }, 2000);
            }
        }
        
        // --- 6. Event Listeners ---
        gameContainer.addEventListener('click', startGame);
        gameOverDiv.addEventListener('click', startGame);
        quizForm.addEventListener('submit', checkAnswer);

    </script>

</body>
</html>
